
// Generated by MyGeneration Version # (1.3.0.3)

using System;
using GrowSurv.DAL;
using System.Collections.Specialized;
using System.Data.SqlClient;
using System.Data;

namespace GrowSurv.BLL
{
	public class Survey : _Survey
	{
		public Survey()
		{
		
		}

        public virtual bool searchSurvies(string filtertxt, int CompanyID)
        {
            string query = string.Format(@"SELECT S.*, U.ArName CompanyArName, U.EnName CompanyEnName
                                        from Company u inner join Survey S  on S.CompanyID = u.CompanyID                                                             
                                    WHERE  ((U.EnName LIKE N'%{0}%') OR (u.ArName LIKE N'%{0}%') OR (S.ArName LIKE N'%{0}%') OR (S.EnName LIKE N'%{0}%') ) and (u.CompanyID = {1} or {1} = 0)", filtertxt, CompanyID);
            return LoadFromRawSql(query);
        }

        public virtual bool GetSurveyDataBySurveyIDAndMemberID(int surveyID, int memberID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);
            parameters.Add(new SqlParameter("@MemberID", SqlDbType.Int, 0), memberID);

            return LoadFromSql("GetSurveyDataBySurveyIDAndMemberID", parameters);

        }

        public virtual bool GetSurveyDataSubQuestionBySurveyIDAndMemberIDAndParentQuestionID(int surveyID, int memberID, int parentID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);
            parameters.Add(new SqlParameter("@MemberID", SqlDbType.Int, 0), memberID);
            parameters.Add(new SqlParameter("@ParentID", SqlDbType.Int, 0), parentID);

            return LoadFromSql("GetSurveyDataSubQuestionBySurveyIDAndMemberIDAndParentQuestionID", parameters);
        }

        public virtual bool GetSurveyDataAnswersBySurveyIDAndMemberIDAndQuestionID(int surveyID, int memberID, int questionID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);
            parameters.Add(new SqlParameter("@MemberID", SqlDbType.Int, 0), memberID);
            parameters.Add(new SqlParameter("@QuestionID", SqlDbType.Int, 0), questionID);

            return LoadFromSql("GetSurveyDataAnswersBySurveyIDAndMemberIDAndQuestionID", parameters);
        }

        public virtual bool GetEvaluation_General(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluation_General", parameters);
        }


        public virtual bool GetEvaluationByCon(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByCon", parameters);
        }

        public virtual bool GetEvaluationByGov(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByGov", parameters);
        }

        public virtual bool GetEvaluationByBranch(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByBranch", parameters);
        }

        public virtual bool GetEvaluationByArea(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByArea", parameters);
        }

        public virtual bool GetEvaluationByDepartment(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByDepartment", parameters);
        }

        public virtual bool GetEvaluationByDivision(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByDivision", parameters);
        }

        public virtual bool GetEvaluationByAgegroup(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByAgegroup", parameters);
        }

        public virtual bool GetEvaluationByLevel(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByLevel", parameters);
        }

        public virtual bool GetEvaluationByJobTitle(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByJobTitle", parameters);
        }

        public virtual bool GetEvaluationByGrade(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByGrade", parameters);
        }

        public virtual bool GetEvaluationByGender(int surveyID)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@SurveyID", SqlDbType.Int, 0), surveyID);

            return LoadFromSql("GetEvaluationByGender", parameters);
        }

    }
}
